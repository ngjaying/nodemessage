var http = require('http');
var url = require('url');

http.createServer(function( request, response ){
    
    var responseFunc = function(){
        response.writeHead('200',{'Content-type' : 'text-plain'});
        response.end(content);  
    }
    
    // Process the argument
    //{url}
    var requestUrl = url.parse(request.url);
    //{String}
    var path = requestUrl.pathname,
      query = requestUrl.query,
      content = 'No Content!',
      fileIndex = (query || '').indexOf('?');
    if(fileIndex === 0){
        query = query.slice(1);
        // Array.[String], may have empty element
        var fileList = query.split(',');
        for(var i=fileList.length - 1;i>=0;i--){
            if(!fileList[i]){
                fileList.splice(i, 1);
            }else{
                fileList[i] = path + fileList[i];
            }
        }
        //TODO: fill the content
        content = fileList.join('\n');
    }
    responseFunc();
    
}).listen(process.env.PORT, process.env.IP);